{"version":3,"sources":["webpack:///./src/lib/components/HorizonGraphD3.js"],"names":["HorizonGraphD3","el","props","update","bind","summaryPlot","margin","top","right","bottom","left","width","height","numberHorizons","Math","min","y","length","xDomain","d3","x","yMax","ceil","flat","yDomain","bands","max","slice","xRange","xScale","size","yScale","padding","uid","random","toString","I","svg","append","attr","g","selectAll","data","i","names","floor","join","_","curve","area","y0","y1","defs","colors","bgcolor","concat","URL","location","d","Array","fill","text","name","fontSize","legendProps","title","tickSize","marginTop","marginRight","marginBottom","marginLeft","n","colorScale","domain","range","copy","colorBar","enter","colorBarScale","legendAxis","scale","ticks","legendTitle","style","call","select","remove","console","log","gBrushes","brushes","ranges","newBrush","brush","extent","on","brushstart","brushed","brushend","push","id","event","sourceEvent","shiftKey","deleted","lastBrushID","lastBrush","document","getElementById","selection","invert","setProps","selectedRanges","drawBrushes","brushSelection","insert","each","brushObject","undefined","exit","xAxis","yAxis","xLabel","yLabel","summarySource","myColor","line","thresholdLine","legend","legendOffset","legendEntries"],"mappings":"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","file":"6d8d393-main-wps-hmr.js","sourcesContent":["import * as d3 from 'd3'\n\nexport default class HorizonGraphD3 {\n    constructor(el, props) {\n        this.update = this.update.bind(this);\n        this.summaryPlot = this.summaryPlot.bind(this);\n\n        var margin = {top: 5, right: 60, bottom: 20, left: 25}, width = props.width - margin.left - margin.right,\n            height = props.height - margin.top - margin.bottom;\n        this.margin = margin;\n        this.width = width;\n        this.height = height;\n\n        // Construct scales and axes\n        this.numberHorizons = Math.min(props.numberHorizons, props.y.length);\n        const xDomain = d3.extent(props.x);\n        const yMax = Math.ceil(d3.max(props.y.flat()));\n        this.yDomain = [0, yMax];\n        this.bands;\n        if(props.numberHorizons < props.y.length) {\n            this.bands = Math.max(2, Math.ceil(d3.max(props.y.slice(this.numberHorizons).flat())));\n        }\n        else {\n            this.bands = 0\n        } // number of bands for lowest plot\n        const bands = yMax;\n        const xRange = [margin.left, width - margin.right];\n        this.xScale = d3.scaleLinear(xDomain, xRange);\n        const size = (height - margin.top - margin.bottom) / (this.numberHorizons + this.bands);\n        this.size = size;\n        const yScale = d3.scaleLinear(this.yDomain, [this.size, size - bands * (size - props.padding)]);\n\n\n        // A unique identifier for clip paths (to avoid conflicts).\n        const uid = `O-${Math.random().toString(16).slice(2)}`;\n\n        const I = d3.range(props.x.length * this.numberHorizons);\n\n        this.svg = d3.select(el).append(\"svg\")\n            .attr('width', width + margin.left + margin.right)\n            .attr('height', height + margin.top + margin.bottom)\n            .append('g')\n            .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n\n        const g = this.svg.selectAll(\"g\")\n            .data(d3.group(I, i => props.names[Math.floor(i / props.x.length)]))\n            .join(\"g\")\n            .attr(\"transform\", (_, i) => 'translate(0, ' + (i * size + margin.top) + ')');\n\n        // Construct an area generator\n        this.curve = d3.curveLinear\n        const area = d3.area()\n            .curve(this.curve)\n            .x(i => {\n                return this.xScale(props.x[i % props.x.length]);\n            })\n            .y0(yScale(0))\n            .y1(i => {\n                return yScale(props.y[Math.floor(i / props.x.length)][i % props.x.length]);\n            });\n\n        const defs = g.append(\"defs\");\n\n        defs.append(\"clipPath\")\n            .attr(\"id\", (_, i) => `${uid}-clip-${i}`)\n            .append(\"rect\")\n            .attr(\"y\", props.padding)\n            .attr(\"width\", width)\n            .attr(\"height\", size - props.padding);\n\n        defs.append(\"path\")\n            .attr(\"id\", (_, i) => `${uid}-path-${i}`)\n            .attr(\"d\", ([, I]) => area(I));\n\n        const colors = [props.bgcolor].concat(d3.schemeReds[Math.max(3, bands - 1)]);\n\n        g\n            .attr(\"clip-path\", (_, i) => `url(${new URL(`#${uid}-clip-${i}`, location)})`)\n            .selectAll(\"use\")\n            .data((d, i) => new Array(bands).fill(i))\n            .join(\"use\")\n            .attr(\"fill\", (_, i) => colors[i])\n            .attr(\"transform\", (_, i) => `translate(0,${i * size})`)\n            .attr(\"xlink:href\", (i) => `${new URL(`#${uid}-path-${i}`, location)}`);\n\n        g.append(\"text\")\n            .attr(\"x\", margin.left)\n            .attr(\"y\", (size + props.padding) / 2)\n            //.attr(\"dy\", \"0.35em\")\n            .text(([name]) => name)\n            .attr(\"font-size\", props.fontSize);\n\n        // Color bar\n        const legendProps = {\n            title: \"Sensitivity\", tickSize: 6, width: 20, height: props.numberHorizons*this.size,// + tickSize,\n            marginTop: margin.top, marginRight: 0, marginBottom: 0,// + tickSize,\n            marginLeft: 20//, ticks: width / 64\n        };\n\n        // function ramp(color, n) {\n        //     const canvas = document.createElement(\"canvas\");\n        //     canvas.width = 1;\n        //     canvas.height = n;\n        //     const context = canvas.getContext(\"2d\");\n        //     for (let i = 0; i < n; ++i) {\n        //         context.fillStyle = color(i);\n        //         context.fillRect(0, n - 1 - i, 1, 1);\n        //     }\n        //     console.log(context)\n        //     return canvas;\n        // }\n\n        const n = Math.min(colors.length, bands);\n        var colorScale = d3.scaleQuantize()\n            .domain([0, yMax])\n            .range(colors.slice(0,n));\n\n        let x = colorScale.copy();\n        var colorBar = this.svg.append(\"g\");\n        colorBar\n            .attr(\"transform\", 'translate(' + (width-margin.right+legendProps.marginLeft) + ',' + (legendProps.marginTop + props.padding) + ')')\n            .selectAll(\"rect\")\n            .data(d3.range(n))\n            .enter()\n            .append(\"rect\")\n            .attr(\"y\", (d) => {return legendProps.height/n*d;})\n            .attr(\"x\", 0)\n            .attr(\"width\", legendProps.width)\n            .attr(\"height\", legendProps.height/n)\n            .attr(\"fill\", (d) => colors[n-1-d]);\n            //.attr(\"x\", width)\n            //.attr(\"y\", legendProps.marginTop + props.padding);\n\n        // colorBar.append(\"image\")\n        //     .attr(\"width\", legendProps.width - legendProps.marginLeft - legendProps.marginRight)\n        //     .attr(\"height\", legendProps.height - legendProps.marginTop - legendProps.marginBottom + props.padding)\n        //     .attr(\"preserveAspectRatio\", \"none\")\n        //     .attr(\"xlink:href\", ramp(colorScale, n).toDataURL());\n\n        var colorBarScale = d3.scaleLinear()\n                .domain([0, yMax])\n                .range([legendProps.height, 0]);\n        var legendAxis = d3.axisRight()\n                .scale(colorBarScale)\n                .ticks(n+1);\n        this.legendTitle = colorBar.append(\"g\")\n            .style(\"font-size\", props.fontSize)\n            .attr(\"transform\", 'translate(' + (legendProps.width) + ',0)')\n            .call(legendAxis)\n            .call(g => g.select(\".domain\").remove())\n            .append(\"text\")\n            .attr(\"x\", -legendProps.height/2)\n            .attr(\"y\", -legendProps.width-5)\n            .attr(\"fill\", \"black\")\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"font-size\", props.fontSize)\n            .text(legendProps.title)\n            .attr(\"transform\", \"rotate(-90)\");\n\n\n        if(props.numberHorizons < props.y.length) {\n            console.log(\"Hier!\");\n            this.summaryPlot(props);\n        }\n\n        // We initially generate a SVG group to keep our brushes' DOM elements in:\n        var gBrushes = this.svg.append('g')\n            .attr(\"class\", \"brushes\");\n\n        // We also keep the actual d3-brush functions and their IDs in a list:\n        var brushes = [];\n\n        var xScale = this.xScale;\n        var ranges = [];\n\n        function newBrush() {\n            var brush = d3.brushX()\n                .extent([[margin.left, 0], [width - margin.right, height -margin.bottom]])\n                .on(\"start\", brushstart)\n                .on(\"brush\", brushed)\n                .on(\"end\", brushend);\n\n            brushes.push({id: brushes.length, brush: brush});\n\n            function brushstart(event) {\n                // your stuff here\n                if(event.sourceEvent.shiftKey) {\n                    gBrushes.selectAll(\".brush\")\n                        .remove();\n                    brushes = [];\n                    ranges = [];\n                    this.deleted = true;\n                }\n            }\n\n            function brushed() {\n                // your stuff here\n            }\n\n\n            function brushend() {\n                if(this.deleted) {\n                    newBrush();\n                }\n                else {\n\n                    // Figure out if our latest brush has a selection\n                    var lastBrushID = brushes[brushes.length - 1].id;\n                    var lastBrush = document.getElementById('brush-' + lastBrushID);\n                    var selection = d3.brushSelection(lastBrush);\n\n                    ranges.push([xScale.invert(selection[0]), xScale.invert(selection[1])]);\n                    props.setProps({selectedRanges: ranges})\n\n                    // If it does, that means we need another one\n                    if (selection && selection[0] !== selection[1]) {\n                        newBrush();\n                    }\n                }\n\n                // Always draw brushes\n                drawBrushes();\n            }\n        }\n\n        function drawBrushes() {\n\n            var brushSelection = gBrushes\n                .selectAll('.brush')\n                .data(brushes, function (d) {\n                    return d.id\n                });\n\n            // Set up new brushes\n            brushSelection.enter()\n                .insert(\"g\", '.brush')\n                .attr('class', 'brush')\n                .attr('id', function (brush) {\n                    return \"brush-\" + brush.id;\n                })\n                .each(function (brushObject) {\n                    //call the brush\n                    brushObject.brush(d3.select(this));\n                });\n\n            /* REMOVE POINTER EVENTS ON BRUSH OVERLAYS\n             *\n             * This part is abbit tricky and requires knowledge of how brushes are implemented.\n             * They register pointer events on a .overlay rectangle within them.\n             * For existing brushes, make sure we disable their pointer events on their overlay.\n             * This frees the overlay for the most current (as of yet with an empty selection) brush to listen for click and drag events\n             * The moving and resizing is done with other parts of the brush, so that will still work.\n             */\n            brushSelection\n                .each(function (brushObject) {\n                    d3.select(this)\n                        .attr('class', 'brush')\n                        .selectAll('.overlay')\n                        .style('pointer-events', function () {\n                            var brush = brushObject.brush;\n                            if (brushObject.id === brushes.length - 1 && brush !== undefined) {\n                                return 'all';\n                            } else {\n                                return 'none';\n                            }\n                        });\n                })\n\n            brushSelection.exit()\n                .remove();\n\n\n            d3.select(\"rect.selection\")\n                .style(\"fill\", \"#dbdbdb\")\n                .style(\"stroke\", \"black\")\n                .style(\"stroke-width\", \"3px\")\n        }\n\n        newBrush();\n        drawBrushes();\n\n/*        this.svg\n            .call(d3.brushX()\n                .extent([[margin.left, -2], [width - margin.right, height + 2]]));*/\n/*        d3.select(\"rect.selection\")\n            .attr(\"fill\", \"#dbdbdb\")\n            .attr(\"stroke\", \"black\")\n            .attr(\"stroke-width\", \"3px\")*/\n    }\n\n    update(props) {\n        //console.log(\"update\");\n    }\n\n    summaryPlot(props) {\n        const summaryPlot = this.svg.append(\"g\");\n\n        // Create new I array with larger numbers\n\n        // Create own yScale\n        //d3.max(props.y.slice(this.numberHorizons).flat())\n        const yScale = d3.scaleLinear([0,this.bands], [this.size*this.bands, props.padding]);\n\n        const area = d3.area()\n            .curve(this.curve)\n            .x(i => {\n                return this.xScale(props.x[i % props.x.length]);\n            })\n            .y0(yScale(0))\n            .y1(i => {\n                return yScale(props.y[Math.floor(i / props.x.length)][i % props.x.length]);\n            });\n\n        const xAxis = d3.axisBottom(this.xScale);\n        const yAxis = d3.axisLeft(yScale).ticks(Math.max(2,this.bands+1));\n\n        summaryPlot\n            .attr(\"transform\", (_, i) => `translate(0,${this.size * (this.numberHorizons) + this.margin.top})`)\n            .append(\"g\")\n            .call(xAxis)\n            .attr(\"transform\", (_, i) => `translate(0,${this.size*this.bands})`);\n\n        // x-label\n        summaryPlot.append(\"text\")\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"x\", this.width/2)\n            .attr(\"y\", this.size*this.bands+this.margin.bottom+props.fontSize)\n            .attr(\"font-size\", props.fontSize)\n            .text(props.xLabel);\n\n        summaryPlot.append(\"text\")\n            //.attr(\"transform\", \"rotate(-90)\")\n            .attr(\"x\", -(this.size*(this.bands+1))/2)\n            .attr(\"y\", -this.margin.left+props.fontSize)\n            .text(\"text-anchor\", \"middle\")\n            .attr(\"font-size\", props.fontSize)\n            .text(props.yLabel)\n            .attr(\"transform\", \"rotate(-90)\");\n\n        summaryPlot\n            .append(\"g\")\n            .call(yAxis)\n            .attr(\"transform\", (_, i) => `translate(${this.margin.left}, 0)`);\n\n        summaryPlot\n            .selectAll(\"text\")\n            .attr(\"font-size\", props.fontSize);\n\n        const I = d3.range(props.x.length * this.numberHorizons, props.x.length * props.y.length);\n\n        var summarySource = summaryPlot.selectAll(\".area\")\n            .data(d3.group(I, i => props.names[Math.floor(i / props.x.length)]))\n            .enter().append(\"g\")\n            .attr(\"class\", function (_, d) {\n                return 'area ${i}';\n            });\n\n        var myColor = d3.scaleOrdinal().domain(props.names.slice(this.numberHorizons))\n            .range(d3.schemeSet2);\n        summarySource.append(\"path\")\n            .attr(\"d\", ([, I]) => area(I))\n            .attr(\"fill\", (d) => {\n                return myColor(d[0]);\n            })\n            .attr(\"opacity\", 0.3);\n\n        // Add lines\n        const line = d3.line()\n            .curve(this.curve)\n            .x(i => {\n                return this.xScale(props.x[i % props.x.length]);\n            })\n            .y(i => {\n                return yScale(props.y[Math.floor(i / props.x.length)][i % props.x.length]);\n            });\n        summaryPlot.selectAll(\".lines\")\n            .data(d3.group(I, i => props.names[Math.floor(i / props.x.length)]))\n            .enter().append(\"g\")\n            .append(\"path\")\n            .attr(\"fill\", \"none\")\n            .attr(\"stroke\", (d) => {return myColor(d[0]);})\n            .attr(\"d\", ([, I]) => {return line(I)})\n\n        const thresholdLine = d3.line()\n            .curve(this.curve)\n            .x(i => {\n                return this.xScale(props.x[i % props.x.length]);\n            })\n            .y(i => {\n                return yScale(1);\n            });\n\n        summaryPlot.append(\"g\")\n            .append(\"path\")\n            .attr(\"fill\", \"none\")\n            .attr(\"stroke\", \"red\")\n            .attr(\"d\", thresholdLine(I.slice(0, props.x.length)));\n\n        //legend\n        var legend = summaryPlot.append(\"g\")\n            .attr(\"transform\", 'translate(' + (this.width-this.margin.right + 20) + ',' +props.legendOffset + ')');\n\n         var legendEntries = props.names.slice(props.numberHorizons);\n        legendEntries.push(\"Threshold\");\n\n        legend\n            .selectAll(\"mylines\")\n            .data(d3.group(d3.range(legendEntries.length), i => legendEntries[i]))\n            .enter()\n            .append(\"rect\")\n            .attr(\"width\", 20)\n            .attr(\"height\", 3)\n            .attr(\"y\", (d) => {return d[1][0]*20})\n            .attr(\"fill\", (d) => {return d[0] === \"Threshold\" ? \"red\" : myColor(d[0]);})\n\n        legend\n            .selectAll(\"mytext\")\n            .data(d3.group(d3.range(legendEntries.length), i => legendEntries[i]))\n            .enter()\n            .append(\"text\")\n            .attr(\"y\", (d) => {return d[1][0]*20 + props.fontSize/2})\n            .attr(\"x\", 25)\n            .text((d) => d[0])\n            .attr(\"font-size\", props.fontSize);\n\n    }\n}"],"sourceRoot":""}
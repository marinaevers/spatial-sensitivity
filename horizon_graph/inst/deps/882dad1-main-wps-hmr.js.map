{"version":3,"sources":["webpack:///./src/lib/components/HorizonGraphD3.js"],"names":["HorizonGraphD3","el","props","update","bind","summaryPlot","margin","top","right","bottom","left","width","height","d3","selectAll","remove","numberHorizons","Math","min","y","length","xDomain","x","yMax","ceil","flat","yDomain","bands","max","slice","xRange","xScale","size","yScale","padding","uid","random","toString","I","svg","append","attr","call","on","d","sourceEvent","type","transform","g","data","i","names","floor","join","_","curve","area","y0","y1","defs","colors","bgcolor","concat","URL","location","Array","fill","text","name","fontSize","legendProps","title","tickSize","marginTop","marginRight","marginBottom","marginLeft","n","colorScale","domain","range","copy","colorBar","enter","colorBarScale","legendAxis","scale","ticks","legendTitle","style","select","console","log","gBrushes","brushes","ranges","newBrush","brush","extent","brushstart","brushed","brushend","push","id","event","shiftKey","deleted","lastBrushID","lastBrush","document","getElementById","selection","invert","setProps","selectedRanges","redraw","numBrushes","drawBrushes","brushSelection","insert","each","brushObject","undefined","exit","xAxis","yAxis","xLabel","yLabel","summarySource","myColor","line","thresholdLine","legend","legendOffset","legendEntries"],"mappings":"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","file":"882dad1-main-wps-hmr.js","sourcesContent":["import * as d3 from 'd3'\n\nexport default class HorizonGraphD3 {\n    constructor(el, props) {\n        this.update = this.update.bind(this);\n        this.summaryPlot = this.summaryPlot.bind(this);\n\n        var margin = {top: 5, right: 60, bottom: 20, left: 25}, width = props.width - margin.left - margin.right,\n            height = props.height - margin.top - margin.bottom;\n        this.margin = margin;\n        this.width = width;\n        this.height = height;\n\n        d3.select(el).selectAll(\"*\").remove();\n\n        // Construct scales and axes\n        this.numberHorizons = Math.min(props.numberHorizons, props.y.length);\n        const xDomain = d3.extent(props.x);\n        const yMax = Math.ceil(d3.max(props.y.flat()));\n        this.yDomain = [0, yMax];\n        this.bands;\n        if (props.numberHorizons < props.y.length) {\n            this.bands = Math.max(2, Math.ceil(d3.max(props.y.slice(this.numberHorizons).flat())));\n        } else {\n            this.bands = 0;\n        } // number of bands for lowest plot\n        const bands = yMax;\n        const xRange = [margin.left, width - margin.right];\n        this.xScale = d3.scaleLinear(xDomain, xRange);\n        const size = (height - margin.top - margin.bottom) / (this.numberHorizons + this.bands);\n        this.size = size;\n        const yScale = d3.scaleLinear(this.yDomain, [this.size, size - bands * (size - props.padding)]);\n\n\n        // A unique identifier for clip paths (to avoid conflicts).\n        const uid = `O-${Math.random().toString(16).slice(2)}`;\n\n        const I = d3.range(props.x.length * this.numberHorizons);\n\n        this.svg = d3.select(el).append(\"svg\")\n            .attr('width', width + margin.left + margin.right)\n            .attr('height', height + margin.top + margin.bottom)\n            .append('g')\n            .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');\n        var svg = this.svg;\n        svg\n            .call(d3.zoom().on(\"zoom\", function (d) {\n                if(d.sourceEvent.type === \"wheel\") {\n                    svg.attr(\"transform\", d.transform)\n                }\n                })\n            )\n\n        const g = this.svg.selectAll(\"g\")\n            .data(d3.group(I, i => props.names[Math.floor(i / props.x.length)]))\n            .join(\"g\")\n            .attr(\"transform\", (_, i) => 'translate(0, ' + (i * size + margin.top) + ')');\n\n        // Construct an area generator\n        this.curve = d3.curveLinear\n        const area = d3.area()\n            .curve(this.curve)\n            .x(i => {\n                return this.xScale(props.x[i % props.x.length]);\n            })\n            .y0(yScale(0))\n            .y1(i => {\n                return yScale(props.y[Math.floor(i / props.x.length)][i % props.x.length]);\n            });\n\n        const defs = g.append(\"defs\");\n\n        defs.append(\"clipPath\")\n            .attr(\"id\", (_, i) => `${uid}-clip-${i}`)\n            .append(\"rect\")\n            .attr(\"y\", props.padding)\n            .attr(\"width\", width)\n            .attr(\"height\", size - props.padding);\n\n        defs.append(\"path\")\n            .attr(\"id\", (_, i) => `${uid}-path-${i}`)\n            .attr(\"d\", ([, I]) => area(I));\n\n        const colors = [props.bgcolor].concat(d3.schemeReds[Math.max(3, bands - 1)]);\n\n        g\n            .attr(\"clip-path\", (_, i) => `url(${new URL(`#${uid}-clip-${i}`, location)})`)\n            .selectAll(\"use\")\n            .data((d, i) => new Array(bands).fill(i))\n            .join(\"use\")\n            .attr(\"fill\", (_, i) => colors[i])\n            .attr(\"transform\", (_, i) => `translate(0,${i * size})`)\n            .attr(\"xlink:href\", (i) => `${new URL(`#${uid}-path-${i}`, location)}`);\n\n        g.append(\"text\")\n            .attr(\"x\", margin.left)\n            .attr(\"y\", (size + props.padding) / 2)\n            //.attr(\"dy\", \"0.35em\")\n            .text(([name]) => name)\n            .attr(\"font-size\", props.fontSize);\n\n        // Color bar\n        const legendProps = {\n            title: \"Sensitivity\", tickSize: 6, width: 20, height: props.numberHorizons * this.size,// + tickSize,\n            marginTop: margin.top, marginRight: 0, marginBottom: 0,// + tickSize,\n            marginLeft: 20//, ticks: width / 64\n        };\n\n        // function ramp(color, n) {\n        //     const canvas = document.createElement(\"canvas\");\n        //     canvas.width = 1;\n        //     canvas.height = n;\n        //     const context = canvas.getContext(\"2d\");\n        //     for (let i = 0; i < n; ++i) {\n        //         context.fillStyle = color(i);\n        //         context.fillRect(0, n - 1 - i, 1, 1);\n        //     }\n        //     console.log(context)\n        //     return canvas;\n        // }\n\n        const n = Math.min(colors.length, bands);\n        var colorScale = d3.scaleQuantize()\n            .domain([0, yMax])\n            .range(colors.slice(0, n));\n\n        let x = colorScale.copy();\n        var colorBar = this.svg.append(\"g\");\n        colorBar\n            .attr(\"transform\", 'translate(' + (width - margin.right + legendProps.marginLeft) + ',' + (legendProps.marginTop + props.padding) + ')')\n            .selectAll(\"rect\")\n            .data(d3.range(n))\n            .enter()\n            .append(\"rect\")\n            .attr(\"y\", (d) => {\n                return legendProps.height / n * d;\n            })\n            .attr(\"x\", 0)\n            .attr(\"width\", legendProps.width)\n            .attr(\"height\", legendProps.height / n)\n            .attr(\"fill\", (d) => colors[n - 1 - d]);\n        //.attr(\"x\", width)\n        //.attr(\"y\", legendProps.marginTop + props.padding);\n\n        // colorBar.append(\"image\")\n        //     .attr(\"width\", legendProps.width - legendProps.marginLeft - legendProps.marginRight)\n        //     .attr(\"height\", legendProps.height - legendProps.marginTop - legendProps.marginBottom + props.padding)\n        //     .attr(\"preserveAspectRatio\", \"none\")\n        //     .attr(\"xlink:href\", ramp(colorScale, n).toDataURL());\n\n        var colorBarScale = d3.scaleLinear()\n            .domain([0, yMax])\n            .range([legendProps.height, 0]);\n        var legendAxis = d3.axisRight()\n            .scale(colorBarScale)\n            .ticks(n + 1);\n        this.legendTitle = colorBar.append(\"g\")\n            .style(\"font-size\", props.fontSize)\n            .attr(\"transform\", 'translate(' + (legendProps.width) + ',0)')\n            .call(legendAxis)\n            .call(g => g.select(\".domain\").remove())\n            .append(\"text\")\n            .attr(\"x\", -legendProps.height / 2)\n            .attr(\"y\", -legendProps.width - 5)\n            .attr(\"fill\", \"black\")\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"font-size\", props.fontSize)\n            .text(legendProps.title)\n            .attr(\"transform\", \"rotate(-90)\");\n\n\n        if (props.numberHorizons < props.y.length) {\n            console.log(\"Hier!\");\n            this.summaryPlot(props);\n        }\n\n        // We initially generate a SVG group to keep our brushes' DOM elements in:\n        var gBrushes = this.svg.append('g')\n            .attr(\"class\", \"brushes\");\n\n        // We also keep the actual d3-brush functions and their IDs in a list:\n        var brushes = [];\n\n        var xScale = this.xScale;\n        var ranges = [];\n\n        function newBrush() {\n            var brush = d3.brushX()\n                .extent([[margin.left, 0], [width - margin.right, height - margin.bottom]])\n                .on(\"start\", brushstart)\n                .on(\"brush\", brushed)\n                .on(\"end\", brushend);\n\n            brushes.push({id: brushes.length, brush: brush});\n\n            function brushstart(event) {\n                // your stuff here\n                if (event.sourceEvent.shiftKey) {\n                    gBrushes.selectAll(\".brush\")\n                        .remove();\n                    brushes = [];\n                    ranges = [];\n                    this.deleted = true;\n                }\n            }\n\n            function brushed() {\n                // your stuff here\n            }\n\n\n            function brushend() {\n                if (this.deleted) {\n                    newBrush();\n                } else {\n\n                    // Figure out if our latest brush has a selection\n                    var lastBrushID = brushes[brushes.length - 1].id;\n                    var lastBrush = document.getElementById('brush-' + lastBrushID);\n                    var selection = d3.brushSelection(lastBrush);\n\n                    ranges.push([xScale.invert(selection[0]), xScale.invert(selection[1])]);\n                    console.log(ranges);\n                    props.setProps({selectedRanges: ranges, redraw: false, numBrushes: ranges.length});\n\n                    // If it does, that means we need another one\n                    if (selection && selection[0] !== selection[1]) {\n                        newBrush();\n                    }\n                }\n\n                // Always draw brushes\n                drawBrushes();\n            }\n        }\n\n        function drawBrushes() {\n\n            var brushSelection = gBrushes\n                .selectAll('.brush')\n                .data(brushes, function (d) {\n                    return d.id\n                });\n\n            // Set up new brushes\n            brushSelection.enter()\n                .insert(\"g\", '.brush')\n                .attr('class', 'brush')\n                .attr('id', function (brush) {\n                    return \"brush-\" + brush.id;\n                })\n                .each(function (brushObject) {\n                    //call the brush\n                    brushObject.brush(d3.select(this));\n                });\n\n            /* REMOVE POINTER EVENTS ON BRUSH OVERLAYS\n             *\n             * This part is abbit tricky and requires knowledge of how brushes are implemented.\n             * They register pointer events on a .overlay rectangle within them.\n             * For existing brushes, make sure we disable their pointer events on their overlay.\n             * This frees the overlay for the most current (as of yet with an empty selection) brush to listen for click and drag events\n             * The moving and resizing is done with other parts of the brush, so that will still work.\n             */\n            brushSelection\n                .each(function (brushObject) {\n                    d3.select(this)\n                        .attr('class', 'brush')\n                        .selectAll('.overlay')\n                        .style('pointer-events', function () {\n                            var brush = brushObject.brush;\n                            if (brushObject.id === brushes.length - 1 && brush !== undefined) {\n                                return 'all';\n                            } else {\n                                return 'none';\n                            }\n                        });\n                })\n\n            brushSelection.exit()\n                .remove();\n\n\n            d3.select(\"rect.selection\")\n                .style(\"fill\", \"#dbdbdb\")\n                .style(\"stroke\", \"black\")\n                .style(\"stroke-width\", \"3px\")\n        }\n\n        newBrush();\n        drawBrushes();\n\n        /*        this.svg\n                    .call(d3.brushX()\n                        .extent([[margin.left, -2], [width - margin.right, height + 2]]));*/\n        /*        d3.select(\"rect.selection\")\n                    .attr(\"fill\", \"#dbdbdb\")\n                    .attr(\"stroke\", \"black\")\n                    .attr(\"stroke-width\", \"3px\")*/\n    }\n\n    update(props) {\n        //console.log(\"update\");\n    }\n\n    summaryPlot(props) {\n        const summaryPlot = this.svg.append(\"g\");\n\n        // Create new I array with larger numbers\n\n        // Create own yScale\n        //d3.max(props.y.slice(this.numberHorizons).flat())\n        const yScale = d3.scaleLinear([0, this.bands], [this.size * this.bands, props.padding]);\n\n        const area = d3.area()\n            .curve(this.curve)\n            .x(i => {\n                return this.xScale(props.x[i % props.x.length]);\n            })\n            .y0(yScale(0))\n            .y1(i => {\n                return yScale(props.y[Math.floor(i / props.x.length)][i % props.x.length]);\n            });\n\n        const xAxis = d3.axisBottom(this.xScale);\n        const yAxis = d3.axisLeft(yScale).ticks(Math.max(2, this.bands + 1));\n\n        summaryPlot\n            .attr(\"transform\", (_, i) => `translate(0,${this.size * (this.numberHorizons) + this.margin.top})`)\n            .append(\"g\")\n            .call(xAxis)\n            .attr(\"transform\", (_, i) => `translate(0,${this.size * this.bands})`);\n\n        // x-label\n        summaryPlot.append(\"text\")\n            .attr(\"text-anchor\", \"middle\")\n            .attr(\"x\", this.width / 2)\n            .attr(\"y\", this.size * this.bands + this.margin.bottom + props.fontSize)\n            .attr(\"font-size\", props.fontSize)\n            .text(props.xLabel);\n\n        summaryPlot.append(\"text\")\n            //.attr(\"transform\", \"rotate(-90)\")\n            .attr(\"x\", -(this.size * (this.bands + 1)) / 2)\n            .attr(\"y\", -this.margin.left + props.fontSize)\n            .text(\"text-anchor\", \"middle\")\n            .attr(\"font-size\", props.fontSize)\n            .text(props.yLabel)\n            .attr(\"transform\", \"rotate(-90)\");\n\n        summaryPlot\n            .append(\"g\")\n            .call(yAxis)\n            .attr(\"transform\", (_, i) => `translate(${this.margin.left}, 0)`);\n\n        summaryPlot\n            .selectAll(\"text\")\n            .attr(\"font-size\", props.fontSize);\n\n        const I = d3.range(props.x.length * this.numberHorizons, props.x.length * props.y.length);\n\n        var summarySource = summaryPlot.selectAll(\".area\")\n            .data(d3.group(I, i => props.names[Math.floor(i / props.x.length)]))\n            .enter().append(\"g\")\n            .attr(\"class\", function (_, d) {\n                return 'area ${i}';\n            });\n\n        var myColor = d3.scaleOrdinal().domain(props.names.slice(this.numberHorizons))\n            .range(d3.schemeSet2);\n        summarySource.append(\"path\")\n            .attr(\"d\", ([, I]) => area(I))\n            .attr(\"fill\", (d) => {\n                return myColor(d[0]);\n            })\n            .attr(\"opacity\", 0.3);\n\n        // Add lines\n        const line = d3.line()\n            .curve(this.curve)\n            .x(i => {\n                return this.xScale(props.x[i % props.x.length]);\n            })\n            .y(i => {\n                return yScale(props.y[Math.floor(i / props.x.length)][i % props.x.length]);\n            });\n        summaryPlot.selectAll(\".lines\")\n            .data(d3.group(I, i => props.names[Math.floor(i / props.x.length)]))\n            .enter().append(\"g\")\n            .append(\"path\")\n            .attr(\"fill\", \"none\")\n            .attr(\"stroke\", (d) => {\n                return myColor(d[0]);\n            })\n            .attr(\"d\", ([, I]) => {\n                return line(I)\n            })\n\n        const thresholdLine = d3.line()\n            .curve(this.curve)\n            .x(i => {\n                return this.xScale(props.x[i % props.x.length]);\n            })\n            .y(i => {\n                return yScale(1);\n            });\n\n        summaryPlot.append(\"g\")\n            .append(\"path\")\n            .attr(\"fill\", \"none\")\n            .attr(\"stroke\", \"red\")\n            .attr(\"d\", thresholdLine(I.slice(0, props.x.length)));\n\n        //legend\n        var legend = summaryPlot.append(\"g\")\n            .attr(\"transform\", 'translate(' + (this.width - this.margin.right + 20) + ',' + props.legendOffset + ')');\n\n        var legendEntries = props.names.slice(props.numberHorizons);\n        legendEntries.push(\"Threshold\");\n\n        legend\n            .selectAll(\"mylines\")\n            .data(d3.group(d3.range(legendEntries.length), i => legendEntries[i]))\n            .enter()\n            .append(\"rect\")\n            .attr(\"width\", 20)\n            .attr(\"height\", 3)\n            .attr(\"y\", (d) => {\n                return d[1][0] * 20\n            })\n            .attr(\"fill\", (d) => {\n                return d[0] === \"Threshold\" ? \"red\" : myColor(d[0]);\n            })\n\n        legend\n            .selectAll(\"mytext\")\n            .data(d3.group(d3.range(legendEntries.length), i => legendEntries[i]))\n            .enter()\n            .append(\"text\")\n            .attr(\"y\", (d) => {\n                return d[1][0] * 20 + props.fontSize / 2\n            })\n            .attr(\"x\", 25)\n            .text((d) => d[0])\n            .attr(\"font-size\", props.fontSize);\n\n    }\n}"],"sourceRoot":""}
{"version":3,"sources":["webpack:///./src/lib/components/HorizonGraphD3.js"],"names":["HorizonGraphD3","el","props","update","bind","margin","top","right","bottom","left","width","height","xDomain","d3","x","yMax","Math","ceil","y","flat","yDomain","bands","xRange","xScale","size","names","length","yScale","padding","xAxis","uid","random","toString","slice","I","svg","append","style","g","selectAll","data","i","floor","join","attr","_","curve","area","y0","y1","defs","colors","bgcolor","concat","max","console","log","URL","location","d","Array","fill","text","name"],"mappings":"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","file":"bdb333a-main-wps-hmr.js","sourcesContent":["import * as d3 from 'd3'\n\nexport default class HorizonGraphD3 {\n    constructor(el, props) {\n        this.update = this.update.bind(this);\n\n        var margin = {top: 10, right: 10, bottom: 10, left: 10}, width = props.width - margin.left - margin.right,\n            height = props.height - margin.top - margin.bottom;\n\n        // Construct scales and axes\n        const xDomain = d3.extent(props.x);\n        const yMax = Math.ceil(d3.max(props.y.flat()));\n        const yDomain = [0, yMax];\n        const bands = yMax;\n        const xRange = [margin.left, width - margin.right];\n        const xScale = d3.scaleLinear(xDomain, xRange);\n        const size = (height-margin.top-margin.bottom)/props.names.length;\n        const yScale = d3.scaleLinear(yDomain, [size, size - bands * (size - props.padding)]);\n        const xAxis = d3.axisBottom(xScale);\n\n        // A unique identifier for clip paths (to avoid conflicts).\n        const uid = `O-${Math.random().toString(16).slice(2)}`;\n\n        const I = d3.range(props.x.length*props.y.length);\n\n        this.svg = d3.select(el).append(\"svg\")\n            .style(\"width\", width)\n            .style(\"height\", height)\n\n        const g = this.svg.selectAll(\"g\")\n            .data(d3.group(I, i => props.names[Math.floor(i/props.x.length)]))\n            .join(\"g\")\n            .attr(\"transform\", (_, i) => 'translate(0, '+(i*size + margin.top)+')');\n\n        // Construct an area generator\n        const curve = d3.curveLinear\n        const area = d3.area()\n            .curve(curve)\n            .x(i => {return xScale(props.x[i%props.x.length]);})\n            .y0(yScale(0))\n            .y1(i => {return yScale(props.y[Math.floor(i/props.x.length)][i%props.x.length]);});\n\n        const defs = g.append(\"defs\");\n\n        defs.append(\"clipPath\")\n            .attr(\"id\", (_, i) => `${uid}-clip-${i}`)\n            .append(\"rect\")\n            .style(\"y\", props.padding)\n            .style(\"width\", width)\n            .style(\"height\", size - props.padding);\n\n        defs.append(\"path\")\n            .attr(\"id\", (_, i) => `${uid}-path-${i}`)\n            .attr(\"d\", ([, I]) => area(I));\n\n        const colors = [props.bgcolor].concat(d3.schemeReds[Math.max(3, bands-1)]);\n        console.log(colors)\n        console.log(bands)\n\n        g\n            .attr(\"clip-path\", (_, i) => `url(${new URL(`#${uid}-clip-${i}`, location)})`)\n            .selectAll(\"use\")\n            .data((d, i) => new Array(bands).fill(i))\n            .join(\"use\")\n            .attr(\"fill\", (_, i) => colors[i])\n            .attr(\"transform\", (_, i) => `translate(0,${i * size})`)\n            .attr(\"xlink:href\", (i) => `${new URL(`#${uid}-path-${i}`, location)}`);\n\n        g.append(\"text\")\n            .attr(\"x\", margin.left)\n            .attr(\"y\", (size + props.padding) / 2)\n            .attr(\"dy\", \"0.35em\")\n            .text(([name]) => name);\n    }\n\n    update(props) {\n\n    }\n}"],"sourceRoot":""}
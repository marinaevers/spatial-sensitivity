{"version":3,"sources":["webpack:///./src/lib/components/FancyParallelCoordinatesD3.js"],"names":["FancyParallelCoordinatesD3","el","props","update","bind","createPCP","margin","top","right","bottom","left","width","dataWidth","height","parent","d3","append","style","svg","attr","dimensions","data","map","label","scales","i","length","domain","range","xScale","padding","values","d","push","foreground","selectAll","enter","path","id","selection","axes","each","call","scale","text","brush","extent","on","selections","Map","key","set","invert","selected","active","Array","from","every","max","min","raise","setProps","dragging","position","v","event","y","__origin__","__dragged__","Math","dx","sort","a","b","transition","p"],"mappings":"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","file":"5b5f086-main-wps-hmr.js","sourcesContent":["import * as d3 from 'd3'\n\nexport default class FancyParallelCoordinatesD3 {\n    constructor(el, props) {\n        this.update = this.update.bind(this);\n        this.createPCP = this.createPCP.bind(this);\n\n        this.margin = {top: 20, right: 0, bottom: 10, left: 0};\n        this.width = props.dataWidth - this.margin.left - this.margin.right;\n        this.height = props.height - this.margin.top - this.margin.bottom;\n\n        this.parent = d3.select(el)\n            .append(\"div\")\n            .style(\"width\", props.width)\n            .style(\"overflow-x\", \"scroll\")\n            .style(\"-webkit-overflow-scrolling\", \"touch\");\n\n        this.svg = this.parent.append('svg')\n            .attr('width', this.width + this.margin.left + this.margin.right)\n            .attr('height', this.height + this.margin.top + this.margin.bottom)\n            .append('g')\n            .attr('transform', 'translate(' + this.margin.left + ',' + this.margin.top + ')');\n\n        this.createPCP(props);\n    }\n\n    update(props) {\n\n    }\n\n    createPCP(props) {\n        var dimensions = props.data.map(({label}) => label);\n\n        // Create axes for data\n        var scales = {}\n        for(let i = 0; i < dimensions.length; i++) {\n            scales[dimensions[i]] = d3.scaleLinear()\n                .domain(props.data[i].range)\n                .range([this.height, 0])\n        }\n\n        // Create x-axes to lay out the y-axes\n        var xScale = d3.scalePoint()\n            .range([0, this.width])\n            .padding(1)\n            .domain(dimensions);\n\n        // draw lines\n        var values = [];\n        props.data.map(function(d) {\n            for(let i = 0; i < d.values.length; i++) {\n                if(values.length < d.values.length) {\n                    values.push({});\n                }\n                values[i][d.label] = d.values[i];\n                values[i]['id'] = i;\n            }\n        });\n        var foreground = this.svg.append(\"g\")\n            .selectAll(\"path\")\n            .data(values)\n            .enter().append(\"path\")\n            .attr(\"d\", path)\n            .style(\"fill\", \"none\")\n            .style(\"stroke\", function(d) {return d.id in props.selection ? \"#005454\" : \"grey\"})\n            .style(\"opacity\", 0.5)\n\n        // Draw the axes\n        var axes = this.svg.selectAll(\"myAxis\")\n            .data(dimensions).enter()\n            .append('g')\n            // move to right position\n            .attr(\"transform\", function(d) {return \"translate(\" + xScale(d) + \")\";})\n            // build axes\n            .each(function(d) {d3.select(this).call(d3.axisLeft().scale(scales[d]));});\n        axes\n            .append(\"text\")\n            .style(\"text-anchor\", \"middle\")\n            .attr(\"y\", -9)\n            .text(function(d) {return d;})\n\n        axes\n            .selectAll(\"path\")\n            .style(\"stroke\", \"red\");\n        axes\n            .selectAll(\"line\")\n            .style(\"stroke\", \"green\");\n        this.svg\n            .selectAll(\"text\")\n            .style(\"fill\", \"purple\");\n\n        // brushing\n        axes\n            .each(function(d) {\n                d3.select(this).call(scales[d].brush = d3.brushY()\n                    .extent([[-10, 0], [10, this.height]])\n                    .on(\"start\", brush)\n                    .on(\"brush\", brush)\n                    .on(\"end\", brush)\n                )\n            })\n            .selectAll(\"rect\")\n            .attr(\"x\", -8)\n            .attr(\"width\", 16);\n\n        var selections = new Map()\n\n        function brush({selection}, key) {\n            if(selection === null) selections.delete(key);\n            else selections.set(key, selection.map(scales[key].invert));\n            const selected = [];\n            foreground.each(function(d) {\n                var active = Array.from(selections).every(([key, [max, min]]) => d[key] >= min && d[key] <= max);\n                d3.select(this).style(\"stroke\", active ? \"#005454\" : \"grey\");\n                if(active) {\n                    d3.select(this).raise();\n                    selected.push(d);\n                    props.setProps({selection: selection})\n                }\n            });\n        }\n\n        // Reordering for axes\n        var dragging = {};\n        function position(d) {\n            var v = dragging[d];\n            return v == null ? xScale(d) : v;\n        }\n        axes.call(d3.drag()\n            .on(\"start\", function(event, d) {\n                if(event.y > this.margin.top) {\n                    return;\n                }\n                dragging[d] = this.__origin__ = xScale(d);\n                this.__dragged__ = false;\n            })\n            .on(\"drag\", function(event, d) {\n                if(!this.__origin__) {\n                    return;\n                }\n                dragging[d] = Math.min(this.width, Math.max(0, this.__origin__ += event.dx));\n                foreground.attr(\"d\", path);\n                dimensions.sort(function(a, b) { return position(a) - position(b); });\n                xScale.domain(dimensions);\n                axes.attr(\"transform\", function(d) { return \"translate(\" + position(d) + \")\"; });\n                this.__dragged__ = true;\n            })\n            .on(\"end\", function(event, d) {\n                if(!this.__dragged__) {\n                    // no movement\n                } else {\n                    //reorder\n                    d3.select(this).transition().attr(\"transform\", \"translate(\"+xScale(d) + \")\");\n                    // TODO: Add brush\n                }\n                xScale.domain(dimensions);\n                delete this.__dragged__;\n                delete this.__origin__;\n                delete dragging[d];\n            }))\n\n\n        // Returns the path for a given data point.\n        function path(d) {\n          return d3.line()(dimensions.map(function(p) { return [xScale(p), scales[p](d[p])]; }));\n        }\n    }\n}\n\n"],"sourceRoot":""}